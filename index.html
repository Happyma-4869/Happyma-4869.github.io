<script>
// ---------------- 粒子动画 ----------------
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
let particlesArray = [];
let mouse = {x:null, y:null};

function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();
window.addEventListener('mousemove', e => { mouse.x = e.x; mouse.y = e.y; });

class Particle {
    constructor(){
        this.x = Math.random()*canvas.width;
        this.y = Math.random()*canvas.height;
        this.size = Math.random()*2+1.5;
        this.speedX = (Math.random()-0.5)*0.5;
        this.speedY = (Math.random()-0.5)*0.5;
        this.color = 'rgba(255,255,255,0.7)';
    }
    update(){
        this.x += this.speedX;
        this.y += this.speedY;

        // 如果鼠标在附近，轻微偏移
        if(mouse.x && mouse.y){
            let dx = mouse.x - this.x;
            let dy = mouse.y - this.y;
            let dist = Math.sqrt(dx*dx + dy*dy);
            if(dist < 100){ // 100px 范围内轻微靠近
                this.x += dx*0.002;
                this.y += dy*0.002;
            }
        }

        if(this.y>canvas.height)this.y=0;
        if(this.x>canvas.width)this.x=0;
        if(this.x<0)this.x=canvas.width;
        if(this.y<0)this.y=canvas.height;
    }
    draw(){
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fill();
    }
}

function initParticles(){
    particlesArray=[];
    let count = 80; // 适中密度
    for(let i=0;i<count;i++){
        particlesArray.push(new Particle());
    }
}
initParticles();

function animateParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particlesArray.forEach(p=>{p.update();p.draw();});
    requestAnimationFrame(animateParticles);
}
animateParticles();
</script>
